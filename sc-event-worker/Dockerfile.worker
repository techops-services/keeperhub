FROM node:22-alpine

ARG KEEPERHUB_API_URL
ARG TIMEOUT_BETWEEN_SYNC
ARG JWT_TOKEN_USERNAME
ARG JWT_TOKEN_PASSWORD
ARG INTERNAL_API_TOKEN

ENV KEEPERHUB_API_URL=${KEEPERHUB_API_URL}
ENV TIMEOUT_BETWEEN_SYNC=${TIMEOUT_BETWEEN_SYNC}
ENV JWT_TOKEN_USERNAME=${JWT_TOKEN_USERNAME}
ENV JWT_TOKEN_PASSWORD=${JWT_TOKEN_PASSWORD}
ENV INTERNAL_API_TOKEN=${INTERNAL_API_TOKEN}

WORKDIR /worker

COPY ./worker* .

RUN npm ci

EXPOSE 3010

CMD ["node", "worker.js"]
